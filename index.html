<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>äº”å­æ£‹_copied_by_Iscream</title>
 
    <style>
        #canvas{
            display: block;
            margin:50px auto;
            box-shadow: -2px -2px 2px #EFEFEF, 5px 5px 5px #b9b9b9;
        }
    </style>
</head>
<body>
 
    <div id="info">
        <span id="timer">Time: 0m 0s</span>
        <span id="steps">Steps: 0</span>
      </div>
          
    <canvas id="canvas"></canvas> 
    <script>
    c=document.getElementById("canvas")
    p=c.getContext("2d")
    //åŸºæœ¬è®¾ç½®
    me=true//true=black false=white
    fs=[]//åˆ†æ•°
    bs=0//æ­¥æ•°
    boxs=[]//è½å­ç‚¹
    wins=[]//èµ¢æ³•
    ms=[]//æˆ‘çš„åˆ†æ•°
    cs=[]//ç”µè„‘çš„åˆ†æ•°
    wh=450//ç”»å¸ƒé•¿å®½
    fs=[]//éšæœºåˆ†æ•°
    long=15//å®½åº¦
    long1=long*2//å®½åº¦1
    qz=13//æ£‹å­å¤§å°
    over=false//æ˜¯å¦ç»“æŸæ¸¸æˆ
    count=0//èµ¢æ³•æ•°é‡
    //æ‰€æœ‰è½å­ç‚¹(äºŒç»´æ•°ç»„) 1=black 2=white
    for (var i=0;i<long;i++){
        boxs[i]=[]
    for (var j=0;j<long;j++){
    boxs[i][j]=0
}
}
var timer = document.getElementById("timer"); // è·å–è®¡æ—¶å™¨çš„ HTML å…ƒç´ 
var steps = document.getElementById("steps"); // è·å–æ­¥æ•°è®¡æ•°çš„ HTML å…ƒç´ 
var startTime; // è®¡æ—¶å™¨å¼€å§‹æ—¶é—´
var elapsedTime = 0; // ç»è¿‡çš„æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰
var stepCount = 0; // æ­¥æ•°è®¡æ•°
var losegameImage = document.createElement("img"); // åˆ›å»ºå›¾ç‰‡å…ƒç´ 
losegameImage.src = "lose_game_over_image.jpg"; // è®¾ç½®å›¾ç‰‡æºè·¯å¾„
var wingameImage = document.createElement("img"); // åˆ›å»ºå›¾ç‰‡å…ƒç´ 
wingameImage.src = "win_game_over_image.jpg"; // è®¾ç½®å›¾ç‰‡æºè·¯å¾„

function showloseGameOverImage() {
    // åœ¨showloseGameOverImageå‡½æ•°ä¸­ä¿®æ”¹ä»¥ä¸‹ä»£ç æ®µ

// è®¾ç½®å›¾ç‰‡æ ·å¼
losegameImage.style.position = "absolute";
losegameImage.style.width = c.width + "px";
losegameImage.style.height = c.height + "px";
losegameImage.style.left = "50%";
losegameImage.style.top = "50%";
losegameImage.style.transform = "translate(-50%, -50%)";

// å°†å›¾ç‰‡æ·»åŠ åˆ° canvas çš„çˆ¶èŠ‚ç‚¹ä¸­
c.parentNode.appendChild(losegameImage);

}
function showwinGameOverImage() {
    // åœ¨showloseGameOverImageå‡½æ•°ä¸­ä¿®æ”¹ä»¥ä¸‹ä»£ç æ®µ

// è®¾ç½®å›¾ç‰‡æ ·å¼
losegameImage.style.position = "absolute";
losegameImage.style.width = c.width + "px";
losegameImage.style.height = c.height + "px";
losegameImage.style.left = "50%";
losegameImage.style.top = "50%";
losegameImage.style.transform = "translate(-50%, -50%)";

// å°†å›¾ç‰‡æ·»åŠ åˆ° canvas çš„çˆ¶èŠ‚ç‚¹ä¸­
c.parentNode.appendChild(wingameImage);

}
// æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
function updateTimer() {
  var currentTime = Date.now();
  elapsedTime = currentTime - startTime;
  var seconds = Math.floor(elapsedTime / 1000);
  var minutes = Math.floor(seconds / 60);
  seconds %= 60;
  timer.textContent = "Time: " + minutes + " min " + seconds + " s";
}

// æ›´æ–°æ­¥æ•°è®¡æ•°
function updateStepCount() {
  steps.textContent = "Steps: " + stepCount + "";
}

// æ¸¸æˆå¼€å§‹æ—¶å¯åŠ¨è®¡æ—¶å™¨
function startTimer() {
  startTime = Date.now();
  setInterval(updateTimer, 1000); // æ¯ç§’æ›´æ–°ä¸€æ¬¡è®¡æ—¶å™¨
}

// æ¯æ¬¡è½å­æ—¶å¢åŠ æ­¥æ•°è®¡æ•°
function incrementStepCount() {
  stepCount++;
  updateStepCount();
}

// åœ¨è½å­çš„é€»è¾‘ä¸­è°ƒç”¨ incrementStepCount() å‡½æ•°æ¥å¢åŠ æ­¥æ•°è®¡æ•°
function gostep(x1, y1, me) {
  // ...
  if (boxs[x][y] == 0) {
    gostep(x, y, me);
    boxs[x][y] = 1;
    // ...
    incrementStepCount(); // å¢åŠ æ­¥æ•°è®¡æ•°
    // ...
  }
  // ...
}

// åœ¨æ¸¸æˆå¼€å§‹æ—¶è°ƒç”¨ startTimer() å‡½æ•°æ¥å¯åŠ¨è®¡æ—¶å™¨
startTimer();


//éšæœºåˆ†æ•°ï¼Œè‡ªå·±æ”¹å§
function randfs(){
for (var i=1;i<5;i++){
    switch (i){
    case 1:
   fs1=random(50,50)
    fs[i]=fs1
    break;
    case 2:
    fs1=random(100,100)
    fs[i]=fs1
    break;
    case 3:
    fs1=random(450,450)
    fs[i]=fs1
    break;
    case 4:
    fs1=random(10000,10000)
    fs[i]=fs1
    break;
}
}
}
randfs()
    //èµ¢æ³•ç»Ÿè®¡æ•°ç»„
    myWin = [];
    computerWin = [];
    //make wins's 3ç»´æ•°ç»„
    for (var i=0;i<long;i++){
        wins[i]=[]
    for (var j=0;j<long;j++){
    wins[i][j]=[]
}
}
    //è·å–572ç§èµ¢æ³•
    for(var i=0;i<long;i++){
	for(var j=0;j<long-4;j++){
		//æ‰§è¡Œ1æ¬¡
		// wins[0][0][0]=true;
		// wins[0][1][0]=true;
		// wins[0][2][0]=true;
		// wins[0][3][0]=true;
		// wins[0][4][0]=true;
		//æ‰§è¡Œ2æ¬¡
		// wins[0][1][1]=true;
		// wins[0][2][1]=true;
		// wins[0][3][1]=true;
		// wins[0][4][1]=true;
		// wins[0][5][1]=true;
		for(var k=0;k<5;k++){
			wins[i][j+k][count] = true;
		}
		count++;
	}
}
//æ‰€æœ‰ç«–çº¿
for(var i=0;i<long;i++){
	for(var j=0;j<long-4;j++){
		for(var k=0; k<5;k++){
			wins[j+k][i][count] = true;
		}
		count++;
	}
}
//æ‰€æœ‰æ–œçº¿'/'
for(var i=0;i<long-4;i++){
	for(var j=0;j<long-4;j++){
		for(var k=0; k<5;k++){
			wins[i+k][j+k][count] = true;
		}
		count++;
	}
}
//æ‰€æœ‰åæ–œçº¿'\'
for(var i=0;i<long-4;i++){
	for(var j=long-1;j>3;j--){
		for(var k=0; k<5;k++){
			wins[i+k][j-k][count] = true;
		}
		count++;
	}
}
//æ•Œæˆ‘åŒæ–¹çš„åœ¨èµ¢æ³•ä¸­çš„æ£‹å­æ•°é‡
for (var i=0;i<count;i++) {
	myWin[i] = 0;
	computerWin[i] = 0;
}
//ç”»å¸ƒé•¿å®½è®¾ç½®
c.width=wh
c.height=wh
//ç”»å¸ƒç»˜ç”»
 var img=new Image()
 img.src="ims.jpg"
 img.onload=function (){
 p.drawImage(img,0,0,450,450)
 }
 //èµ°ä¸€æ­¥
 function gostep(x,y,me){
     //è¿˜æ˜¯ä½¿æ£‹å­è½åœ¨åæ ‡ç³»ä¸Š
     var x=x*long1+long
     var y=y*long1+long
     //ç”»å­
     var gradient = p.createRadialGradient(x,y,qz,x,y,0);
     p.beginPath()
     p.arc(x,y,qz,0,360)
     p.closePath()
    if (me){
        //é»‘æ–¹
        gradient.addColorStop(0,"#0A0A0A");
		gradient.addColorStop(1,"#636766");
           }
else{
    //ç™½æ–¹
    gradient.addColorStop(0,"#D1D1D1");	
    	gradient.addColorStop(1,"#F9F9F9");
}
    p.fillStyle = gradient;
	p.fill();
}
//ç”»å¸ƒå•å‡»äº‹ä»¶
c.onclick=function (e){
    //æ£€æµ‹æ¸¸æˆæ˜¯å¦ç»“æŸ
    if (over){
    
    return
}
    //ä½¿æ£‹å­è½åœ¨åæ ‡ç³»ä¸Š
    var x=Math.floor(e.offsetX/long1)
    var y=Math.floor(e.offsetY/long1)
    //æ£€æµ‹æ˜¯å¦è½å­
    if (boxs[x][y]==0){
    gostep(x,y,me)
    boxs[x][y]=1
    //æ­¥æ•°åŠ ä¸€
    bs++
    incrementStepCount();
    //æ£€æµ‹ä½ æ˜¯å¦èµ¢
    for (var i=0;i<count;i++){
    if (wins[x][y][i]){
    myWin[i]++
    computerWin[i]=6
    if (myWin[i]==5){
        over=true
    setTimeout(function (){
    alert("ç»ˆäºèµ¢äº†")
},300);showwinGameOverImage();
}
}
}
}
else{
    return
}
if (bs==long*long){
    alert("å’Œæ£‹!å‰å®³å•Šï¼Œä½ å’Œaiä¸€æ ·èªæ˜å‘¢ğŸ˜ˆ")
    over=true
}
if (!over){
   //éšæœºåˆ†æ•°
    randfs()
   //æœ€å¼ºäººæœº
    ai(x,y)
}
    me=!me
}
function ai() {
    var bestScore = -Infinity;
    var move;

    // éå†æ£‹ç›˜ä¸Šçš„æ¯ä¸ªç©ºä½
    for (var i = 0; i < long; i++) {
        for (var j = 0; j < long; j++) {
            if (boxs[i][j] == 0) {
                // è¯•æ¢æ€§åœ°è½å­
                boxs[i][j] = 2;
                var score = minimax(boxs, 0, false);
                // æ¢å¤æ£‹ç›˜çŠ¶æ€
                boxs[i][j] = 0;
                // æ›´æ–°æœ€ä½³å¾—åˆ†å’Œè½å­ä½ç½®
                if (score > bestScore) {
                    bestScore = score;
                    move = { x: i, y: j };
                }
            }
        }
    }

    // æœ€ä½³è½å­ä½ç½®
    gostep(move.x, move.y, false);
    boxs[move.x][move.y] = 2;
}

function minimax(board, depth, isMaximizing) {
    var result = checkWinner();
    if (result !== null) {
        return result == 2 ? 10 : -10;
    }

    if (isMaximizing) {
        var bestScore = -Infinity;
        for (var i = 0; i < long; i++) {
            for (var j = 0; j < long; j++) {
                if (board[i][j] == 0) {
                    board[i][j] = 2;
                    var score = minimax(board, depth + 1, false);
                    board[i][j] = 0;
                    bestScore = Math.max(score, bestScore);
                }
            }
        }
        return bestScore;
    } else {
        var bestScore = Infinity;
        for (var i = 0; i < long; i++) {
            for (var j = 0; j < long; j++) {
                if (board[i][j] == 0) {
                    board[i][j] = 1;
                    var score = minimax(board, depth + 1, true);
                    board[i][j] = 0;
                    bestScore = Math.min(score, bestScore);
                }
            }
        }
        return bestScore;
    }
}

//éšæœºæ•°
function random(a,b){
   var c=Math.floor(Math.random()*(b-a+1)+a);
    return c
}
    </script>
</body>
</html>
